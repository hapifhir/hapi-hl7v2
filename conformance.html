<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.4 at 2017-06-23 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20170623" />
    <meta http-equiv="Content-Language" content="en" />
    <title>HAPI &#x2013; Conformance Tools</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
      </head>
    <body class="topBarDisabled">
      <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="https://hapifhir.github.io/hapi-hl7v2" id="bannerLeft"><img src="images/hapi_banner.png"  alt="HAPI"/></a></div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2017-06-23<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 2.3</li>
      <li class="pull-right"><span class="divider">|</span>
<a href="http://www.uhn.ca/" class="externalLink" title="University Health Network">University Health Network</a></li>
      <li class="pull-right"><span class="divider">|</span>
<a href="http://hl7.org/" class="externalLink" title="hl7.org">hl7.org</a></li>
      <li class="pull-right"><a href="https://github.com/hapifhir/hapi-hl7v2" class="externalLink" title="GitHub Project Page">GitHub Project Page</a></li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
<ul class="nav nav-list">
          <li class="nav-header">Welcome</li>
    <li><a href="index.html" title="Introduction"><span class="none"></span>Introduction</a>  </li>
    <li><a href="changes-report.html" title="Changelog"><span class="none"></span>Changelog</a>  </li>
    <li><a href="https://smilecdr.com/blog/" class="externalLink" title="Blog"><span class="none"></span>Blog</a>  </li>
          <li class="nav-header">FHIR</li>
    <li><a href="hapi-fhir/" title="HAPI FHIR"><span class="none"></span>HAPI FHIR</a>  </li>
          <li class="nav-header">Tools</li>
    <li><a href="hapi-testpanel/index.html" title="TestPanel"><span class="none"></span>TestPanel</a>  </li>
    <li><a href="hapi-hl7overhttp/index.html" title="HL7 over HTTP"><span class="none"></span>HL7 over HTTP</a>  </li>
    <li><a href="colouriser.html" title="Colouriser"><span class="none"></span>Colouriser</a>  </li>
          <li class="nav-header">Download</li>
    <li><a href="https://sourceforge.net/projects/hl7api/files/hl7api/" class="externalLink" title="Download Java API"><span class="none"></span>Download Java API</a>  </li>
    <li><a href="hapi-testpanel/install.html" title="Download TestPanel"><span class="none"></span>Download TestPanel</a>  </li>
          <li class="nav-header">Documentation</li>
    <li><a href="getting_started.html" title="Getting Started"><span class="none"></span>Getting Started</a>  </li>
    <li><a href="devbyexample.html" title="HAPI By Example"><span class="none"></span>HAPI By Example</a>  </li>
    <li><a href="base/apidocs/index.html" title="JavaDoc (API core)"><span class="icon-chevron-down"></span>JavaDoc (API core)</a>
      <ul class="nav nav-list">
    <li><a href="v21/apidocs/index.html" title="v2.1 Messages"><span class="none"></span>v2.1 Messages</a>  </li>
    <li><a href="v22/apidocs/index.html" title="v2.2 Messages"><span class="none"></span>v2.2 Messages</a>  </li>
    <li><a href="v23/apidocs/index.html" title="v2.3 Messages"><span class="none"></span>v2.3 Messages</a>  </li>
    <li><a href="v231/apidocs/index.html" title="v2.3.1 Messages"><span class="none"></span>v2.3.1 Messages</a>  </li>
    <li><a href="v24/apidocs/index.html" title="v2.4 Messages"><span class="none"></span>v2.4 Messages</a>  </li>
    <li><a href="v25/apidocs/index.html" title="v2.5 Messages"><span class="none"></span>v2.5 Messages</a>  </li>
    <li><a href="v251/apidocs/index.html" title="v2.5.1 Messages"><span class="none"></span>v2.5.1 Messages</a>  </li>
    <li><a href="v26/apidocs/index.html" title="v2.6 Messages"><span class="none"></span>v2.6 Messages</a>  </li>
    <li><a href="v27/apidocs/index.html" title="v2.7 Messages"><span class="none"></span>v2.7 Messages</a>  </li>
    <li><a href="v28/apidocs/index.html" title="v2.8 Messages"><span class="none"></span>v2.8 Messages</a>  </li>
    <li><a href="v281/apidocs/index.html" title="v2.8.1 Messages"><span class="none"></span>v2.8.1 Messages</a>  </li>
      </ul>
  </li>
    <li><a href="xref/index.html" title="Source XRef"><span class="none"></span>Source XRef</a>  </li>
    <li><a href="hapi-faq.html" title="FAQ"><span class="none"></span>FAQ</a>  </li>
    <li class="active"><a href="#"><span class="none"></span>Conformance Tools</a>
  </li>
    <li><a href="hapi-sourcegen/confgen-usage.html" title="Maven Plugins"><span class="none"></span>Maven Plugins</a>  </li>
          <li class="nav-header">Get Help</li>
    <li><a href="mail-lists.html" title="Mailing List"><span class="none"></span>Mailing List</a>  </li>
          <li class="nav-header">Contribute</li>
    <li><a href="building.html" title="Hacking HAPI"><span class="none"></span>Hacking HAPI</a>  </li>
    <li><a href="submissions.html" title="Submitting Code"><span class="none"></span>Submitting Code</a>  </li>
    <li><a href="issue-tracking.html" title="Issue Tracking"><span class="none"></span>Issue Tracking</a>  </li>
    <li><a href="source-repository.html" title="Source Code"><span class="none"></span>Source Code</a>  </li>
          <li class="nav-header">Reports</li>
    <li><a href="team-list.html" title="HAPI Developers"><span class="none"></span>HAPI Developers</a>  </li>
    <li><a href="surefire-report.html" title="Unit Test Report"><span class="none"></span>Unit Test Report</a>  </li>
    <li><a href="taglist.html" title="Source Tag List"><span class="none"></span>Source Tag List</a>  </li>
    <li><a href="cobertura/index.html" title="Cobertura"><span class="none"></span>Cobertura</a>  </li>
    <li><a href="findbugs.html" title="FindBugs"><span class="none"></span>FindBugs</a>  </li>
    <li><a href="license.html" title="License"><span class="none"></span>License</a>  </li>
          <li class="nav-header">Older Documentation</li>
    <li><a href="parsing.html" title="Parsing Messages"><span class="none"></span>Parsing Messages</a>  </li>
    <li><a href="installation.html" title="Installation"><span class="none"></span>Installation</a>  </li>
    <li><a href="links.html" title="Helpful Links"><span class="none"></span>Helpful Links</a>  </li>
  </ul>
          <hr />
          <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
  <a href="http://maven.apache.org" title="Built with Maven 2" class="builtBy"><img class="builtBy"  alt="Built with Maven 2" src="images/logos/maven-feather.png"    /></a>
              </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<p>HAPI includes several tools which may be used to work with Conformance Profiles.</p>
<div class="section">
<h2><a name="Conformance_Class_Generator"></a>Conformance Class Generator</h2>
<p>HAPI 1.1 introduced a new conformance class generator, which takes a conformance profile and generates a HAPI message definition. This is useful both to constrain/remove unwanted elements from a message type, as well as to extend a message type by adding custom segments.</p>
<p>This feature was developed by University Health Network, and is currently being used quite heavily in a production ESB/interface engine to create message structures for translating messages between arbitrary formats. Applications that can produce message with custom Z-segments, out of order segments, and other nuances are no longer an issue. </p>
<p>For a complete reference on how the plugin works, check out the <a href="./hapi-sourcegen/confgen-mojo.html">Maven Plugin Documentation</a></p>
<p>Important: Note that this functionality is still a work in progress, and has the following limitations:</p>
<ul>
<li>Fields which are marked as &quot;not used&quot; are not yet constrained away. As such, this plugin is really currently only useful for extending existing message types, not constraining them. Constraining is the next planned use-case for implementation. Get in touch if you would like to help.</li>
<li>The new generator is only provided as a Maven plugin. Converting it to work with Ant or as a standalone application would be fairly easy, please get in touch if you would like to contribute. </li></ul>
<div class="section">
<h3><a name="Usage"></a>Usage</h3>
<p>First, generate a conformance profile using the <a class="externalLink" href="http://www.hl7.org/documentcenter/public/wg/ictc/MWB%20Release%206.8.zip">Message Workbench</a> tool. This tool will export your profile as an XML file, which can be read by the conformance class generator. Save this file in your project under </p>
<div class="source"><pre class="prettyprint">  src/main/conf/conf.xml</pre></div>
<p>Next, add the Maven plugin to your pom:</p>
<div class="source"><pre class="prettyprint">&lt;plugins&gt;
  &lt;plugin&gt;
    &lt;groupId&gt;ca.uhn.hapi&lt;/groupId&gt;
    &lt;artifactId&gt;hapi-sourcegen&lt;/artifactId&gt;
    &lt;version&gt;${hapi.version}&lt;/version&gt;
    &lt;executions&gt;
      &lt;execution&gt;
        &lt;phase&gt;generate-sources&lt;/phase&gt;
        &lt;goals&gt;
          &lt;goal&gt;confgen&lt;/goal&gt;
        &lt;/goals&gt;
        &lt;configuration&gt;

          &lt;!-- This is the conformance profile file to use --&gt;
          &lt;profile&gt;${basedir}/src/main/resources/example_ack.xml&lt;/profile&gt;

          &lt;!-- Place generated Java source here --&gt;
          &lt;targetDirectory&gt;${basedir}/target/generated-sources/confgen&lt;/targetDirectory&gt;

          &lt;!-- Generated classes will be placed here --&gt;
          &lt;packageName&gt;com.foo&lt;/packageName&gt;

       &lt;/configuration&gt;
      &lt;/execution&gt;
    &lt;/executions&gt;
  &lt;/plugin&gt;
&lt;/plugins&gt;  </pre></div>
<p>You will now have a &quot;com.foo&quot; package containing your newly generated classes. If you are using eclipse, you might now want to add the following directory to your source path so that you can see the generated sources:</p>
<div class="source"><pre class="prettyprint">target/generated-sources/confgen</pre></div>
<p>To see an example:</p>
<ul>
<li>View the conformance profile XML file <a class="externalLink" href="http://hl7api.cvs.sourceforge.net/viewvc/hl7api/hapi-mvn/hapi-examples/src/main/resources/ca/uhn/hl7v2/examples/profiles/ADT_A31.xml?view=markup">HERE</a>.</li>
<li>View the generated source classes <a href="./xref/com/foo/a31/message/ADT_A05.html">HERE</a>.</li></ul></div></div>
<div class="section">
<h2><a name="Runtime_Message_Validator"></a>Runtime Message Validator</h2>
<p>The <a class="externalLink" href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/conf/check/DefaultValidator.html">Default Validator</a> accepts a conformance profile and validates a message against it at runtime. Example usage:</p>
<div class="source"><pre class="prettyprint">// Load the profile from the classpath
ProfileParser parser = new ProfileParser(false);
RuntimeProfile profile = parser.parseClasspath(&quot;ca/uhn/hl7v2/conf/parser/example_ack.xml&quot;);

// Create a message to validate
String message = &quot;MSH|^~\\&amp;|||||||ACK^A01|1|D|2.4|||||CAN|wrong|F^^HL70001^x^^HL78888|\r&quot;; //note HL7888 doesn't exist
ACK msg = (ACK) (new PipeParser()).parse(message);

// Validate
HL7Exception[] errors = new DefaultValidator().validate(msg, profile.getMessage());

// Each exception is a validation error
System.out.println(&quot;Validation errors: &quot; + Arrays.asList(errors));</pre></div>
<div class="section">
<h3><a name="Older_tools"></a>Older tools</h3>
<p>Version 0.4 of HAPI introduces several features related to the HL7 conformance framework. There are also several non-HAPI conformance tools. </p>
<p>The conformance framework was introduced in HL7 2.5. In a nutshell, it defines a way of writing detailed message specifications using XML. An XML message specification is called a &quot;profile&quot;. For more information on conformance, please refer to HL7 2.5 section 2.12 or the <a class="externalLink" href="http://www.hl7.org/Special/committees/conformance/conform.htm">Conformance SIG</a>. </p>
<p><b>HAPI 0.4 introduces the following conformance tools</b>: </p>
<table border="1" class="table table-striped">
<tr class="a">
<td align="left"><a href="./conf/compiler.html">Profile Compiler</a></td>
<td align="left">Turns a profile into a Java JAR. The JAR contains an API with all the constraints of the profile, so that coding against it will prevent you from producing non-compliant messages. Many non-conformances are caught at compile time, the rest at run-time.</td></tr>
<tr class="b">
<td align="left"><a href="./conf/constraint_analyzer.html">Constraint Analyzer</a></td>
<td align="left">Determines whether one profile properly constrains another.</td></tr>
<tr class="a">
<td align="left"><a class="externalLink" href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/hl7api/hapi/ca/uhn/hl7v2/conf/store/">Profile Store</a></td>
<td align="left">In progress. Currently saves/loads profiles to/from local disk. Will load profiles from HL7's on-line registry and cache them locally in next version.</td></tr></table></div>
<div class="section">
<h3><a name="Non-HAPI_Conformance_Tools"></a>Non-HAPI Conformance Tools </h3>
<table border="1" class="table table-striped">
<tr class="a">
<td align="left"><a class="externalLink" href="http://www.hl7.org/lib_admin/docs.cfm?dir=library/committees/conf&amp;comm=conf">The Messaging Workbench</a></td>
<td align="left">This is a graphical profile editor created by Peter Rontey of the US Veteran's Administration. It can be downloaded from the HL7 Conformance SIG's documents page.</td></tr>
<tr class="b">
<td align="left"><a class="externalLink" href="http://www.nist.gov/messagemaker">Message Maker</a></td>
<td align="left">This tool by Rob Snelick and colleagues (NIST) generates test messages from a conformance profile.</td></tr>
<tr class="a">
<td align="left"><a class="externalLink" href="http://hl7api.sourceforge.net/conf/Conf_FOP.zip">PDF Transform</a></td>
<td align="left">Lloyd McKenzie and Jennifer Puyenbroek's XSL stylesheet which transforms a profile into PDF or HTML.</td></tr>
<tr class="b">
<td align="left"><a class="externalLink" href="http://www.ahml.com.au/">Australian Healthcare Messaging Laboratory</a></td>
<td align="left">A service by which messages can be checked for conformance to a profile or to HL7 in general.</td></tr>
<tr class="a">
<td align="left"><a class="externalLink" href="http://www.hl7.org/Library/Committees/Conf/HL7v2GlobalMessageProfileLibraryjan2003V3.pdf">HL7 Global Profile Registry</a></td>
<td align="left">A service with which HL7 members can share profiles for their products or regions. This is a link to the users guide which has instructions for accessing the registry.</td></tr>
<tr class="b">
<td align="left"><a class="externalLink" href="http://www.orionhealth.com/symphonia_overview.htm">Orion Tools</a></td>
<td align="left">Closed-source tools in the same vein as HAPI.</td></tr></table>
<p><b>Possible future work includes</b>:</p>
<table border="1" class="table table-striped">
<tr class="a">
<td align="left">Profile Generator</td>
<td align="left">Currently the Messaging Workbench (above) can reverse-engineer a profile from a message. There has been some talk about extending this so that a profile can be created from a set of messages, which would be very useful in that it would allow us to create status quo profiles for legacy interfaces. If Peter doesn't do it, maybe we'll implement this into HAPI at some point.</td></tr></table></div></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2001&#x2013;2017
<a href="http://www.uhn.ca">University Health Network</a>.
All rights reserved.</p>
        </div>
        </div>
    </footer>
    </body>
</html>