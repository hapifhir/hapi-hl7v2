<?xml version="1.0"?>
<document xmlns="http://maven.apache.org/changes/1.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/changes/1.0.0 ./changes.xsd">
	<properties>
		<title>HAPI</title>
	</properties>
	<body>
		<release version="2.6.0" date="2025-02-04">
			<action type="fix" dev="Ken Stevens">
				It is now possible to explicitly specify a socket connect timeout on newly created client
				sockets.
			</action>
		</release>
		<release version="2.5.2" date="2024-05-16">
			<action type="fix" dev="Ken Stevens">
				AbstractMessage.copy() changed Z segments within the message. This has been corrected
				so the copy() method now returns an identical copy of the original message.
			</action>
		</release>
		<release version="2.5.1" date="2023-11-01">
			<action type="fix" dev="Emre Dincturk">
				SimpleServer now waits for its server socket to be closed when stopAndWait is called.
				This makes it easier for consumers of SimpleServer to reuse the port after stopping the server
				without implementing a wait for the port to be released themselves.
			</action>
		</release>
		<release version="2.4.1" date="2023-11-01">
			<action type="fix" dev="Emre Dincturk">
				SimpleServer now waits for its server socket to be closed when stopAndWait is called.
				This makes it easier for consumers of SimpleServer to reuse the port after stopping the server
				without implementing a wait for the port to be released themselves.
			</action>
		</release>
		<release version="2.5" date="2023-10-30">
			<action type="change" dev="James Agnew">
				HAPI HL7v2 2.5 is identical to HAPI FHIR 2.4, but uses the jakarta.servlet
				packages instead of the javax.servlet packages. All versions of HAPI HL7v2 going
				forward will contain this change.
			</action>
		</release>
		<release version="2.4" date="2023-10-30">
			<action type="change" dev="James Agnew">
				As of HAPI HL7v2 2.4, HAPI FHIR now requires JDK 11 or newer in order to build or use the library.
			</action>
			<action type="fix" dev="James Agnew">
				The XML parser was vulnerable to XXE injections (meaning that the XML
				parser could be coerced into inadvertently loading the contents of files
				on the local filesystem). It is highly recommended to upgrade to this
				release in order to mitigate this issue.
			</action>
			<action type="fix">
				Testpanel: Correct a NullPointerException when opening a message from a text file
			</action>
			<action type="fix">
				Testpanel: Prevent a failure to autosave messages when TestPanel is closing if the charset has not been selected
			</action>
			<action type="fix">
				Testpanel: Fix formatting issue when displaying sent/received messages containing HTML fragments
			</action>
			<action type="fix" dev="Nathan Doef">
				Fix an issue with the AbstractMessage#copy() method where non-standard
		                segments were not being added at the same position as the original message.
		    	</action>
	    		<action type="add" dev="Nathan Doef">
		                Add a new copy() method to AbstractMessage that recursively loops over
		                every Structure and parses / encodes the contents of each AbstractSegment
		                into the copied message.
		    	</action>
			<action type="fix" dev="Christian Ohr" issue="35">
				The Connection interface now extends Closeable. As a consequence, the close()
				method now throws IOException. Thanks to hauntingEcho for the proposal.
			</action>
			<action type="fix" dev="Christian Ohr" issue="33">
				Fixes problem with missing items in PopulatingVisitor.
				Thanks to mourezwell for the pull request.
			</action>
			<action type="fix" dev="Christian Ohr" issue="31">
				Allow Visitor or Terser API to filter for repeated field. Thanks to
				mourezwell for the pull request.
			</action>
			<action type="fix" dev="Christian Ohr" issue="22">
				Fix namespace handling when XML-encoding messages. Thanks to kbalthaser for reporting.
			</action>
			<action type="fix" dev="Christian Ohr" issue="7">
				Fix encoding of line breaks as \X000d\
			</action>
			<action type="fix">
				When calling Parser#parse(Message, String), the parser now sets itself
				as the parser associated with the message. This causes the parser's
				validation settings to be applied during parse instead of
				default settings being applied.
			</action>
			<action type="add" issue="2">
				Add an optional mode to SimpleServer where all received messages are
				processed, even including unexpected ACK messages. Thanks to
				Tom Chiverton for the pull request!
			</action>
			<action type="fix">
				A concurrency issue causing an exception when parsing or receiving multiple
				messages in parallel has been resolved.
			</action>
			<action type="add" issue="26">
				A new protocol error handler has been added to the LLP layer. Thanks to
				Sumeet Chhetri for the pull request!
			</action>
		</release>
		<release version="2.3" date="2017-06-23">
            <action type="fix" dev="Christian Ohr" system="newbugs" issue="242">
                Improve SegmentFinder performance. Thanks to Niels HarremoÃ«s for reporting.
            </action>
            <action type="fix" dev="Christian Ohr">
                Fixed field numbers of handling MFE-4/MFE-5 varies types
            </action>
            <action type="fix" dev="Christian Ohr" system="newbugs" issue="241">
                Consistently use longs in ID generators. Thanks to Samantha Chan for reporting.
            </action>
			<action type="fix" dev="Christian Ohr" system="newbugs" issue="240">
				Fix missing location field in NAK messages. Thanks to Christian Woerns for reporting.
			</action>
            <action type="fix" dev="Christian Ohr" system="newbugs" issue="239">
                Fix wrong case in Role and Identifier elements in conformance profile parsing. Thanks to Jens Villadsen.
            </action>
			<action type="fix" dev="Christian Ohr" system="newbugs" issue="238">
				Fix serialization of TerserMessageRule. Thanks to Sebastian Tacke for reporting.
			</action>
			<action type="fix" dev="Christian Ohr" system="newbugs" issue="234">
				Avoid NullPointerException with non-existing conformance profile. Thanks to Ulrich Metzger for reporting.
			</action>
			<action type="fix" dev="Rolf Thorup" system="newbugs" issue="229">
				Fix daylight savings issue in CommonTM. Thanks to Rolf Thorup for reporting and the fix.
			</action>
            <action type="fix" dev="Christian Ohr">
                Conformance profile validation skips Varies fields. Thanks to Pablo Leon for reporting
            </action>
			<action type="add" dev="Christian Ohr">
				Add option to MessageValidator to validate primitives, too.
				Note that this slows down the validation significantly
			</action>
            <action type="fix" dev="Christian Ohr" system="newbugs" issue="226">
                Do not embed slf4j into OSGi bundle (rely on PAX logging). With thanks to juantxorena.
            </action>
            <action type="fix" dev="Christian Ohr" system="newbugs" issue="207">
                Avoid that empty segments are added during parsing. With thanks to Jens Villadsen.
            </action>
            <action type="add" dev="Christian Ohr" system="newfeatures" issue="92">
                Allow messages to be wrapped as unmodifiable.
            </action>
            <action type="add" dev="Christian Ohr" system="newfeatures" issue="91">
                Allow messages to be created from within an HapiContext.
            </action>
            <action type="fix" dev="Christian Ohr" system="newbugs" issue="224">
                Fix isEmpty() and clear() in TSComponentOne. Thanks to Sebastian Tacke for reporting.
            </action>
			<action type="fix" dev="Christian Ohr" system="newbugs" issue="223">
				Avoid NullPointerException using DefaultHapiContext close method. Thanks to Domingo Amado for reporting.
			</action>
			<action type="fix" dev="Christian Ohr" system="newbugs" issue="222">
				CustomModelClassfactory should not check for valid versions. Thanks to Ambassador Software Works for reporting.
			</action>
			<action type="add" dev="Christian Ohr" system="newfeatures" issue="89">
				Allow to unregister/unbind applications from ApplicationRouter. Thanks to Mathieu for the proposal
			</action>
			<action type="add" dev="Christian Ohr" system="newfeatures" issue="87">
				Make default acknowledgement code configurable in ApplicationRouterImpl. With thanks to Jens Villadsen.
			</action>
			<action type="add" dev="Christian Ohr" system="newfeatures" issue="86">
				Throw new TimeoutException (subclass of Hl7Exception) is HL7 server fails to answer. With thanks to Jens Villadsen.
			</action>
			<action type="add" dev="Christian Ohr" system="newfeatures" issue="85">
				Add type parameter to ReceivingApplication. With thanks to Jens Villadsen.
			</action>
			<action type="fix" dev="Christian Ohr" system="newbugs" issue="216">
				Improve exception message. Thanks to DiGiT for reporting.
			</action>
            <action type="fix" dev="Christian Ohr" system="newbugs" issue="213">
                    Fix CustomModelClassFactory implementation, returning the correct message structure
            </action>
            <action type="fix" dev="James Agnew">
            	HapiContext now supplies a default Server Configuration, which prevents an 
            	unrelated error from showing up in logs if an unparseable message is received.
            </action>
        </release>			
		<release version="2.2" date="2014-03-04" description="This release contains a number of big fixes, a newly rewritten MLLP implementation and several API enhancements.">
            <action type="fix" dev="Christian Ohr" system="newbugs" issue="176">
            	XML Parsing now also works if the HL7v2 XML namespace is not the default namespace 
				(i.e. tags have namespace prefixes). Thanks to Eugene Berman for reporting! 
            </action>			
			<action type="fix" dev="James Agnew" issue="180" system="newbugs">
	         	Fix issue where HohRawClientMultithreaded (HL7 over HTTP Multithreaded Client)
	         	fails to reconnect automatically when the server side unexpectedly closes
	         	the connection. 
			</action>
			<action type="fix" dev="James Agnew" issue="182" system="newbugs">
				Correct a crash when using CanonicalModelClassFactory with a fixed message class (not version)
				and parsing a message containing unexpected/custom Z segments.
			</action>
			<action type="fix" dev="Chris Stoten">
				Modify ExtendedMinLLPWriter (a part of the ExtendedMinLowerLayerProtocol LLP implementation)
				so that it doesn't flush the network buffer between the LLP start block and the 
				actual message (causing issues transmitting messages to some Websphere implementations). 
				Thanks to Chris Stoten of UHN for all of the hard work in getting this figured out.
			</action>
			<action type="add" dev="James Agnew">
				HL7 over HTTP relay now adds its own product name to any error messages it
				returns in a NAK message, so that it is easier when troubleshooting to distinguish
				a NAK which is coming back from the destination system vs. a NAK which is generated
				by the relay itself (e.g. because the destination is unreachable).
			</action>
			<action type="fix" dev="James Agnew">
				Fix the "xsdconfgen" Maven plugin so that it adds generated artifacts to the 
				current build as resources instead of compile sources.
			</action>
			<action type="fix" dev="Christian Ohr" issue="179" system="newbugs">
				Fix a minor issue in the HAPI bootstrap process where a classpath inputstream
				wasn't closed properly, leading to weird artifacts in logs when HAPI based applications
				are redeployed on some application servers (e.g. Glassfish 3.x).
			</action>
			<action type="fix" dev="James Agnew">
				Correct an issue in hapi-hl7overhttp where the HOH Server implementations incorrectly
				fail to detect the content type if the charset isn't specified by the client.
			</action>
            <action type="add" dev="Christian Ohr" issue="80" system="newfeatures">
                Added methods to HapiContext and ConnectionHub that allow to lazily create a
                client connection, i.e. the physical connection is established only right
                before the first message is sent over it.
            </action>
            <action type="add" dev="James Agnew" issue="183" system="newbugs">
            	Correcting a bug in the HL7 over HTTP client code where GZipped
            	HTTP responses are not properly interpreted as being GZipped. 
            </action>
            <action type="add" dev="Christian Ohr" issue="76" system="newfeatures">
                Reimplemented MinLLP readers and writers. MSH-18 handling is configured by the
                parameter in the constructor MinLowerLayerProtocol(boolean).
                ExtendedMinLowerLayerProtocol has been deprecated.
            </action>
            <action type="add" dev="Anthony Rakic" issue="186" system="newbugs">
                Correct an issue with the HL7 over HTTP Relay where concurrent messages
                being relayed at the same time may result in misdirected ACK responses.
            </action>
            <action type="add" dev="James Agnew">
                Add a new convenience method to text primitives (ST, TX, etc.) called "getValueOrEmpty()"
                which returns an empty string instead of null, and modify ID and IS to use the
                AbstractTextPrimitive base class so that they can take advantage.
            </action>
            <action type="fix" dev="Brennan O'Banion" issue="190" system="newbugs">
                Fix a typo in AbstractValidationExceptionHandler, where "info" severity
                exceptions aren't handled. Thanks to Brennan O'Banion for reporting and
                submitting a fix.
            </action>
            <action type="add" dev="James Agnew">
                HL7 over HTTP client now properly respects "Connection=close" header in responses
            </action>
            <action type="add" dev="James Agnew">
                Add a new method to HapiContext, getServerConfiguration. This method returns
                a configuration bean, much like getParserConfiguration() which can be used to
                configure receiving servers created by the given context.
            </action>
            <action type="add" dev="James Agnew">
           		Add a configuration option to the new ServerConfiguration bean which sets the policy
           		for how to handle exceptions thrown by receiving applications. This can be used to 
           		configure HAPI to not send a response message back, which can be useful when dealing
           		with problematic legacy systems.
            </action>
            <action type="fix" dev="Paul Schwartz" issue="191" system="newbugs">
                Fix exception when HL7 over HTTP servlet receives message larger than 4K. Thanks to
                Paul Schwartz for contributing a bug report and pinpointing the cause.             
            </action>
            <action type="fix" dev="James Agnew" issue="192" system="newbugs">
            	Fix problem where Superstructures (such as 
            	<![CDATA[
            	<a href="./v25/apidocs/ca/uhn/hl7v2/model/v25/message/ADT_AXX.html">this one</a>
            	]]>
            	) do not support all of the types they should. For example, ADT_AXX would allow an
            	ADT^A04 message to parse, but not an ADT^A01. This is now fixed.
            </action>
            <action type="fix" dev="Ryan Baldwin" issue="199" system="newbugs">
            	Fix an issue where the XML parser ignores "extra components", unlike the Pipe parser.
            	For example, if a CX.4 element is found within a CX field, the XML parser would not
            	grab its contents. This is now corrected. Thanks to Ryan Baldwin for
            	the diagnosis.
            </action>
            <action type="add" dev="James Agnew">
            	HL7 over HTTP client now comes with several configuration options to
            	set the socket properties (SO_timeout, Keepalive, etc.)
            </action>
            <action type="add"  issue="77" system="newfeatures" dev="James Agnew">
            	HL7 over HTTP relay now mentions itself in NAK messages it generates (which makes it
            	easier to tell if a NAK is coming from the relay because it couldn't reach its target,
            	or if the NAK is actually from the target)
            </action>
            <action type="add" dev="James Agnew">
            	Add two new methods to ParserConfiguration which allow the disabling of
            	whitespace trimming at the individual node level, and on a global level. This
            	configuration replaces the "setKeepAsOriginalNodes" method on the XMLParser, which
            	is somewhat confusingly named. Thanks to Ryan Baldwin for help in diagnosing the
            	need for this. 
            </action>
            <action type="fix" issue="202" system="newbugs" dev="James Agnew">
            	Fix an issue where the XML parser incorrectly encodes text values which contain an
            	escape sequence (e.g. \E\) at the very end of the value. Thanks to Ioan Salau for reporting!
            </action>
            <action type="add" dev="Christian Ohr">
                Make HL7 escaping strategy configurable over ParserConfiguration API
            </action>
            <action type="fix" issue="193" system="newbugs" dev="Christian Ohr">
                HapiContext now implements Closeable
            </action>
            <action type="add" dev="Christian Ohr">
                Apply visitor pattern to message validation: a message can be validated by
                letting a MessageVisitor traverse the message and collect potential problems
            </action>
            <action type="add" dev="James Agnew">
                Allow HL7 over HTTP Relay users to set the read timeout on connections
            </action>
            <action type="fix" dev="James Agnew" issue="206" system="newbugs">
                Fix a regression in HAPI 2.2-beta1 which caused the first portion of a received message
                to be processed as a complete message when the reading socket times out part way through the
                message. This issue does not affect previous versions of HAPI.
            </action>
            <action type="add" dev="James Agnew">
                HL7 over HTTP implementation updated to match specification changes by HL7 ITS WG: 
                HL7 responses always use HTTP 200, UTF-8 is default (and changing it is deprecated)
            </action>
		</release>
        <release version="2.1" date="2013-03-21" description="This release introduces the HapiContext and brings many new features">
        	<action type="add" dev="James Agnew" issue="155" system="newbugs">
            	HAPI is now able to work without any structure JARs for basic tasks, and can
            	process unknown versions of HL7 (e.g. 2.99) if configured to allow this.
            	See
            	<![CDATA[
            	<a href="http://hl7api.sourceforge.net/apidocs/ca/uhn/hl7v2/parser/GenericModelClassFactory.html">GenericModelClassFactory</a>
            	]]>
            	for more information.
            </action>
        	<action type="fix" dev="Christian Ohr" issue="3590954">
            	Fixed incorrect trimming rule for TX. Thanks to SÃ¸ren Therkildsen for reporting.
            </action>
        	<action type="fix" dev="Christian Ohr" issue="3571839">
            	Fixed incorrect generation of ACK messages for HL7 versions newer
            	than 2.4. Thanks to Anne-Gaelle for reporting.
            </action> 
          	<action type="add" dev="Christian Ohr" issue="3570493">
        		ModelClassFactory define their own event map location, where the
        		mapping between event and message structure is defined.
        		Compatibility notice: Parser.getMessageStructureForEvent is not static anymore
        		and was deprecated.
        	</action>
        	<action type="fix" dev="Christian Ohr" issue="1834598">
            	Fixed bug in DefaultXMLParser. Thanks to Leo Marcov for reporting.
            </action> 
			<action type="fix" dev="Jens Villadsen, Christian Ohr" issue="3552470">
            	Deprecated LowerLayerProtocol.makeLLP as there is now the choice
            	between MinLowerLayerProtocol and ExtendedMinLowerLayerProtocol.
            </action> 
          	<action type="add" dev="Christian Ohr">
        		ValidationContext can now be more conveniently configured using
        		ValidationRuleBuilders. All predefined ValidationContext classes have
        		been reimplemented to be defined by such builders.
        	</action>
            <action type="fix" dev="Christian Ohr" issue="3564428">
            	HapiContext becomes the unique source of configuration. Changing a
            	context object immediately changes the configuration of all connected
            	parsers, servers etc. Message-specific ValidationContext has been
            	deprecated and will be removed in the next version. 
            </action>        
            <action type="fix" dev="Christian Ohr" issue="3515725">
            	XML Parser is now able to handle escape sequences that are relevant for
            	XML encoding when parsing and rendering. Thanks to Alberto Saez Torres
            	for reporting.
            </action>
            <action type="add" dev="Christian Ohr" issue="3515833">
            	Introduced HapiContext, which aggregates most of the configuration and allows
            	to instantiate correspondingly configured HAPI services 
            	(parsers, validators, servers, ...).
            </action>
            <action type="add" dev="Christian Ohr" issue="3515828">
            	All XML processing is based on DOM Level 3 and uses the standard libraries, 
				which are included in JRE 5 and newer.
				Therefore, no external XML-related libraries are required anymore.
				<![CDATA[<br><br>]]>
				The default XML implementation can be overridden this by setting the system property 
				<![CDATA[<code>org.w3c.dom.DOMImplementationSourceList</code>]]> 
				to the external DOM implementation and
				<![CDATA[<code>org.xml.sax.driver</code>]]> 
				to an external SAX implementation. 
				<![CDATA[<br><br>]]>
				When Xerces 2.11 is used as
				external XML processor library, 
				<![CDATA[<code>org.w3c.dom.DOMImplementationSourceList</code>]]> 
				must be
				set to 
				<![CDATA[<code>org.apache.xerces.dom.DOMXSImplementationSourceImpl</code>]]> 
				and 
				<![CDATA[<code>org.xml.sax.driver</code>]]>
				must
				be set to 
				<![CDATA[<code>org.apache.xerces.parsers.SAXParser</code>]]>.
            </action>
            <action type="add" dev="Christian Ohr" issue="3515832">
            	Added a set of new message ID generators, to be centrally configured using the
				ParserConfiguration class. Provides non-persistent generators and the
				possibility to plug in custom ID generators.
            </action>
            <action type="add" dev="Christian Ohr" issue="3494927">
            	Make Message Validation more versatile by adding a ValidationExceptionHandler
				that is called on every violation of a validation rule. A new implementation
				of such a handler (RespondingValidationExceptionHandler) is capable of creating
				response messages based on the validation result.
            </action>			
        	<action type="add" dev="James Agnew">
        		Minor API enhancements:
        		<![CDATA[
        		<ul>
        			<li>
        				ConnectionHub has a new factory method which accepts an LLP instance but
        				does not require a boolean flag to indicate whether TLS is being
        				used (added for consistency with other methods).
        			</li>
        			<li>
        				A number of internal log statements which are only really useful
        				if you are familiar with HAPI internals have been changed from
        				DEBUG level to TRACE level, to make debug level logging easier 
        				to understand.
        			</li>
        			<li>
        				Service classes (such as SimpleServer) now have a startAndWait() method
						which doesn't return until the service has successfully started
        			</li>
        			<li>
        				When GenericParser parses a message, the 
						<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/Message.html#getParser()">Parser</a>
        				instance associated with the message is set appropriately to either the
        				Pipe Parser or the XML Parser. This means that calls to
        				generateAck().encode()
        				will generate a message with the appropriate encoding. 
        			</li>
        		]]>
        	</action>
        	<action type="fix" dev="James Agnew">
        		AbstractMessage#generateAck()
        		now sets the Parser instance associated with the generated Ack message to 
        		be the same instance as its own instance. This means for instance that if a
        		message is parsed from an XML message, the same XML parser will be associated
        		with the generated ACK. 
        	</action>
            <action type="fix" dev="James Agnew">
            	Prevent UnsupportedOperationException when AbstractType#toString() is called on a message
            	that was parsed by an XML parser (for instance on an ST, or another datatype).
            </action>			
            <action type="fix" dev="James Agnew" issue="3558687">
            	<![CDATA[<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/app/ConnectionHub.html">ConnectionHub</a>]]>
            	and
            	<![CDATA[<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/app/SimpleServer.html">SimpleServer</a>]]>
            	now each accept a custom
            	<![CDATA[<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/util/SocketFactory.html">socket factory</a>]]>
            	instance, which can be used to allow custom configuration on sockets,
            	or special TLS configurations. This checkin also corrects an issue where the
            	"tls" parameter on ConnectionHub was not honoured.       	
            </action>
            <action type="fix" dev="mmartin (laguna27)" issue="3566636">
            	Fix an issue parsing XML encoded messages where any segment groups with a four letter
            	name are ignored (e.g. the DIET group in an OMD_O01 message). Thanks to mmartin
            	for providing a test case demonstrating the issue!
            </action>
            <action type="fix" issue="169" system="newbugs" dev="DiGiT">
            	Fix an issue where SegmentFinder can't find PID2 within an A24 message.
            	Thanks to DiGiT for providing a working test case!
            </action>
        	<action type="add" dev="James Agnew" issue="166" system="newbugs">
            	<![CDATA[
            	<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/primitive/AbstractTextPrimitive.html#getValueAsHtml%28%29">AbstractTextPrimitive#getValueAsHtml()</a>
            	]]>
            	now properly escapes HTML reserved characters:
            	<![CDATA[<br/>
            	&lt; &gt; &amp;
            	]]>
            </action>
        	<action type="fix" dev="Christian Ohr" issue="162" system="newbugs">
				Fix an issue that prevented the sample code for
            	<![CDATA[
            	<a href="http://hl7api.sourceforge.net/xref/ca/uhn/hl7v2/examples/CustomModelClasses.html">Custom Model Classes</a>
            	]]>
            	from working properly. Thanks to Michael Connor for reporting.
            </action>
        	<action type="fix" dev="James Agnew" issue="159" system="newbugs">
				Allow messages which contain "choices" within their structures to 
				parse correctly. For example, the ORM_O01 v2.5 message has a structure
				called ORDER_DETAIL which can have any one of 6 different segments as
				its first segment. Previously HAPI treated all as required and 
				failed to correctly parse in many cases. 
				
				Thanks to Paulo Ferreira for reporting! 
            </action>
        	<action type="fix" dev="James Agnew" issue="95" system="newbugs">
        		v2.3 structure for ORC-14 is correctly set to XTN datatype (was previously TN)
            </action>
            <action type="fix" dev="James Agnew" issue="134" system="newbugs">
            	Improve error message in
            	<![CDATA[
            		<a href="http://hl7api.sourceforge.net/apidocs/ca/uhn/hl7v2/llp/ExtendedMinLowerLayerProtocol.html">ExtendedMinLowerLayerProtocol</a>
            	]]> 
            	when an incoming
            	message can't be processed because it contains an invalid MSH segment.
            	Thanks to Jens Villadsen for reporting!
            </action>
            <action type="fix" dev="Nicolas Lefebvre" issue="123" system="newbugs">
				Allow
				<![CDATA[
            		<a href="http://hl7api.sourceforge.net/apidocs/ca/uhn/hl7v2/protocol/ReceivingApplicationExceptionHandler.html">ReceivingApplicationExceptionHandler</a>
            	]]> 
				to process exceptions even when un-parseable messages are received.				            	
            </action>
            <action type="fix" dev="James Agnew" issue="64" system="newfeatures">
				New parser configuration option for customizing
				<![CDATA[
            		<a href="http://hl7api.sourceforge.net/apidocs/ca/uhn/hl7v2/parser/ParserConfiguration.html#setUnexpectedSegmentBehaviour(ca.uhn.hl7v2.parser.UnexpectedSegmentBehaviourEnum)">Unexpected segment (e.g. Z-segment) behaviour</a>
            	]]> 
				in terms of where in the structure the segment gets placed. Thanks to Michael Connor for
				suggesting this!				            	
            </action>
            <action type="fix" dev="James Agnew" issue="67" system="newbugs">
				Prevent eventmap from containing structure mappings that shouldn't exist
				because the source structure exists. For example, in v2.3.1 there should not
				be a mapping from ADT_A34 to ADT_A30, because there is a structure for
				ADT_A34 itself. Thanks to hirion86 for reporting this! 				            	
            </action>
            <action type="fix" dev="Giacomo Petronio" issue="75" system="newfeatures">
            	Correct unhelpful error logging in HohRawServlet when the HL7 over HTTP
            	servlet has an error decoding a request. Thanks to Giacomo Petronio for
            	reporting and providing a fix! 
            </action>
            <action type="fix" dev="James Agnew" issue="171" system="newbugs">
            	Introduce new PipeParser
				<![CDATA[
            		<a href="http://hl7api.sourceforge.net/apidocs/ca/uhn/hl7v2/parser/ParserConfiguration.html#setNonGreedyMode(boolean)">non-greedy mode</a>
            	]]> 
            	which can be used to give the parser hints on how to 
            	proceed when the choice of where to put the next
            	segment is ambiguous between moving to a child group later in the
            	message structure or moving to a new repetition of a parent structure. 
				<![CDATA[
            		<br/><br/>
            	]]> 
            	Thanks to Pablo Pazos for reporting and providing a test case!
            </action>
            <action type="fix" dev="James Agnew">
            	Improve the documentation on the
            	<![CDATA[ 
            		<a href="hapi-sourcegen/confgen-usage.html">Maven Plugins</a>
            	]]>
            	and introduce a new plugins for generating
            	<![CDATA[ 
            		<a href="hapi-sourcegen/superstructuregen-usage.html">Superstuctures</a>
            	]]>
            	and
            	<![CDATA[ 
            		<a href="hapi-sourcegen/xsdconfgen-usage.html">XSDs</a>
            	]]>
            </action>
            <action type="fix" dev="Christian Ohr" system="newbugs" issue="172">
            	Fix a regression in 2.1-beta1 where DefaultXMLParser would not encode
            	correctly on certain environments because of an error relating
            	to XML "pretty print" support. 
            	<![CDATA[ 
            		<br/><br/>
            	]]>
            	As a part of this fix, a new ParserConfiguration option has also been
            	added to optionally disable pretty printing if desired. Thanks Steffan Rachner
            	for reporting! 
            </action>
		</release>
		<release version="2.0" date="2012-07-16" description="This release contains a complete overhaul of the SimpleServer infrastructure, a move to SLF4J, a new LLP implementation, and many other enhancements and bugfixes!">
        	<action type="fix">
				<![CDATA[
        		<i>Regression in 2.0-beta1:</i> 
				]]>
        		Fix issue where occasionally a Connection which is
        		sending a message would ignore an ACK/response message it received and report 
        		that the send timed out. 
        	</action>
        	<action type="add">HAPI has now switched from CVS to Subversion for version control purposes. The new repo 
        	can be accessed at:
				<![CDATA[
	            	<a href="https://hl7api.svn.sourceforge.net/svnroot/hl7api">https://hl7api.svn.sourceforge.net/svnroot/hl7api</a>
				]]>
			The old CVS repo will be kept around for now, just in case it is needed. 
        	</action>
            <action type="add" dev="Christian Ohr" issue="3388301">
            	Refactored large parts of the networking functionality in the ca.uhn.hl7v2.app package. Most
				notably, an ExecutorService instance can be injected to customize the threading behavior.
            </action>
			<action type="add" dev="Christian Ohr / James Agnew" issue="3421082">
            	Make TestPanel more usable. Amongst other changes, it's now possible to load HL7 messages 
				directly from a file and to reuse client-side connections even when the MLLP server was 
				restarted in the meanwhile.
            </action>
        	<action type="add" dev="Christian Ohr" issue="3421083">
        		Convert HAPI to use the 
				<![CDATA[
	            	<a href="http://www.slf4j.org/">SLF4J</a>
				]]>
        		logging framework in place of Apache Jakarta Commons-Logging (JCL). SLF4J is 
        		conceptually similar to JCL, in that it is a wrapper around an underlying 
        		framework of your choice (e.g. log4j, java.util.Logger, etc.). It brings a number
        		of modern features with it, such as parameterized entries and NDCs, and uses a
        		less confusing discovery process.
				<![CDATA[<br><br>]]>
				Applications which use HAPI will now need to add the "slf4j-api.jar" JAR to their
				classpath, as well as a second JAR such as "slf4j-log4j12.jar" which instructs SLF4J
				which underlying log framework to use. These two dependencies have been added to the
				hapi-base pom.xml, so Maven users will see this change automatically.
				<![CDATA[<br><br>]]>
        		In addition, HapiLog has been deprecated. HapiLog was used as a logging system prior to
        		the introduction of commons-logging into HAPI. It is no longer referenced by any
        		part of HAPI itself, and will be removed at some point in the future.
        	</action>
        	<action type="add" dev="James Agnew">
        		Add new method to group and message structure classes that returns all repetitions
        		of repeatable children as a typed List. This is useful for quickly and easily
        		iterating over structures within a message.
        		<![CDATA[<br/><br/>]]>
        		For example, ADT_A01 has a repeatable OBX segment. It is now possible to access it
        		in three ways:
        		<![CDATA[
        			<ul>
        				<li><a href="http://hl7api.sourceforge.net/v26/apidocs/ca/uhn/hl7v2/model/v26/message/ADT_A01.html#getOBX()">OBX getOBX()</a>, which returns the first repetition, creating it if neccesary
        				<li><a href="http://hl7api.sourceforge.net/v26/apidocs/ca/uhn/hl7v2/model/v26/message/ADT_A01.html#getOBX(int)">OBX getOBX(int rep)</a>, which returns a specific repetition
        				<li><a href="http://hl7api.sourceforge.net/v26/apidocs/ca/uhn/hl7v2/model/v26/message/ADT_A01.html#getOBXAll()">List&lt;OBX&gt; getOBXAll()</a>, which returns all repetitions (or an empty list if there are none)
        			</ul>
        		]]>
        	</action>
        	<action type="add" dev="Jens Kristian Villadsen" issue="3518763">
        		Add a new LowerLayerProtocol implementation which respects MSH-18 (Character Set)
        		values to determine the underlying transport character set. See
        		<![CDATA[
        		<a href="/xref/ca/uhn/hl7v2/examples/HandlingCharacterEncodings.html">here</a>
        		]]>
        		for an example.
        		<![CDATA[<br><br>]]>
        		In addition, 
        		<![CDATA[
        		<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/llp/MinLowerLayerProtocol.html">MinLowerLayerProtocol</a>
        		]]>
        		has received a new constructor which accepts a CharSet as a parameter, meaning
        		that individual LLP instances may have their CharSet specified, as opposed to
        		using a global
        		<![CDATA[
        		<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/llp/MinLLPReader.html#CHARSET_KEY">System Property</a>
        		<br><br>
        		]]>
        		Note that a dependency existed in HAPI 2.0-beta1 on XML libraries being
        		present on the classpath. This has been corrected in HAPI 2.0. 
        	</action>
        	<action type="add" dev="Christian Ohr">
        		Modernize a bunch of the code base to add proper generics support.
        	</action>
        	<action type="fix" dev="Christian Ohr" issue="3001226">
        		Fixed a race issue that starts the Receiver thread before an Application instance is attached.
				On the client side, when you don't use the ConnectionHub (you should!), make sure to call Connection#activate() 
				before sending messages. On the server-side, this is done automatically.
        	</action>			
        	<action type="fix" dev="Christian Ohr / Jason Thompson" issue="3410095">
        		Correct an integer overflow issue when
        		<![CDATA[
        		<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/primitive/CommonTS.html#setValue(java.util.Calendar)">CommonTS#setValue(Calendar)</a>
        		]]> 
        		is invoked with a calendar containing some high
        		timezone offset values. Thanks to Jason Thompson for reporting and
        		providing a fix.
        	</action>
        	<action type="fix" dev="James Agnew">
        		<![CDATA[
        		<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/primitive/CommonTS.html#getValueAsCalendar()">CommonTS#getValueAsCalendar()</a>
        		]]>
        		now sets the TimeZone associated with the returned Calendar object to have a TZ-offset equivalent to the
        		offset provided in the raw HL7 data (e.g. if the value was "201201010800-0400", Calendar.setTimeZone(TimeZone) will be called with
        		a timezone containing GMT-4:00). 
        		<![CDATA[
        		<br><br>
        		]]>
        		This prevents issues when parsing times in a locale with Daylight Savings Time outside of
        		the current DST window, such as parsing 201201010800-0400 in Toronto in June, when the DST offset is actually -0500.  
        		<![CDATA[
        		<br><br>
        		]]>
        	</action>
        	<action type="fix" dev="James Agnew">
        		Correct several minor issues with CommonTS and TSComponentOne. Specifically:
        		<![CDATA[
        		<ul>
        			<li>
        				Allow setValue(String) to work correctly if the previous value was 
        				invalid (instead of throwing a DataTypeException).
        			</li>
        			<li>
        				getValueAsDate() and getValueAsCalendar() now return null if the
        				field contains null, instead of throwing a NullPointerException.
        			</li>
        		]]>
        	</action>
        	<action type="add" dev="James Agnew">
        		A new configuration bean,
        		<![CDATA[
        		<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/parser/ParserConfiguration.html">ParserConfiguration</a>
        		]]>
        		has been added which allows the parser to be configured
        		for specific behaviour.
        		<![CDATA[
        		<a href="configuring_hapi.html">See here</a>
        		]]>
        		for more information.
        	</action>
        	<action type="add" dev="James Agnew">
        		Add a new method to 
        		<![CDATA[
        		<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/util/Hl7InputStreamMessageStringIterator.html">Hl7InputStreamMessageStringIterator</a>
        		]]>
        		and
        		<![CDATA[
        		<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/util/Hl7InputStreamMessageIterator.html">Hl7InputStreamMessageIterator</a>
        		]]>
        		called setIgnoreComments(boolean) which allows the iterator to
        		ignore lines beginning with a hash (#). This allows you to put
        		comments in files being read by these classes.
        	</action>
        	<action type="fix" dev="Diederik Muylwyk">
        		Correct two issues with 
        		<![CDATA[
        		<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/AbstractPrimitive.html#parse(java.lang.String)">AbstractPrimitive#parse(String)</a>
        		]]>
        		This is the method which is used (for example)
        		if parse is called on an ST type. Previously if an escape sequence (e.g. "Snakes \T\ Ladders") was 
        		passed into this method, it would appear double-escaped when the message was re-encoded, giving
        		a string such as "Snakes \E\T\E\ Ladders". In addition, if this method was called and the string
        		passed in contained a field delimiter (generally "^") this would lead to an IllegalArgumentException
        		in some cases. Thanks to Diederik Muylwyk for reporting this and providing a test case!
        	</action>
        	<action dev="Eric Poiseau" type="add" issue="124" system="newbugs">
        		Allow conformance profile structure generator to handle ID and IS type definitions with namespaced 
        		table numbers (e.g. IHE0155). These are now generated as special subclasses of 
        		ID 
        		and 
        		IS
        		, called 
        		IDWithNamespace
        		and 
        		ISWithNamespace 
        		respectively. These types have a method, getTableNamespace() which retrieves the non
        		numeric part of the table name.
        	</action>
        	<action dev="Nicolas Lefebvre" type="add">
        		Add a new method to 
        		Parser, 
        		parseForSpecificPackage, 
        		which parses messages using structure classes
        		found in a particular package instead of using the built in HAPI defaults.
        	</action>
        	<action dev="James Agnew" issue="3323850" type="fix">
        		HL7 escape sequences, such as \X0000\, \H\, and \N\ are all now correctly handled
        		when they are parsed and encoded. Previously, if one of these sequences were found within
        		a field in a parsed message, they would be incorrectly encoded when the message was
        		re-encoded. Thanks to anonymous bug poster for reporting this and providing a working
        		test case!
        	</action>
			<action dev="Neal Acharya" type="add">
				String structure types (ST, FT, TX) now have a new method
				<![CDATA[
					<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/primitive/AbstractTextPrimitive.html#getValueAsHtml()">getValueAsHtml()</a>
				]]>
				which converts any HL7 formatting codes (\H\, \.sp 55\, \.ce\, etc.) in the string to their HTML equivalent. This 
				functionality can also be used to convert any other string containing HL7 formatting codes to the
				equivalent HTML codes using:
				<![CDATA[
					<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/primitive/FormattedTextEncoder.html">FormattedTextEncoder</a>
				]]>
			</action>
        	<action dev="James Agnew" type="fix">
				Calling 
				stop() 
				on 
				HL7Server 
				should also request that any processors which are active for that server stop as well. 
				This prevents stray worker threads from staying alive and cluttering application logs 
				after the server is stopped.        	
			</action>
        	<action dev="James Agnew" type="add">
				Minor API changes:
				<![CDATA[
					<ul>
						<li>Add a new method to Connection, <a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/app/Connection.html#getRemotePort()">getRemotePort</a>, which returns the port number of the remote socket the connection is bound to.</li>
						<li>Add several new factory methods to <a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/app/ConnectionHub.html">ConnectionHub</a> which allow creating a new connection using an instantiated instance of a LowerLayerProtocol implementation instead of just supplying a type to be instantiated by ConnectionHub</li>
						<li>Add new method to <a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/app/SimpleServer.html>SimpleServer</a> and <a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/app/TwoPortService.html">TwoPortService</a> called <a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/app/concurrent/Service.html#getServiceExitedWithException()">getServiceExitedWithException()</a>. In the event that the service exits unexpectedly, this method allows you to retrieve the exception which caused the failure (e.g. a <a href="<a href="http://docs.oracle.com/javase/6/docs/api/java/net/BindException.html">BindException</a> in the event that the port was already in use by another application).</li>						
						<li>Modify Conformance Profile <a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/conf/check/DefaultValidator.html">DefaultValidator</a> so that it can be used to validate individual parts of a message (e.g. only one segment, group, etc.) and not just the entire message</li>						
					</ul>
				]]>
			</action>
			<action dev="James Agnew" type="fix">
				<![CDATA[
					<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/Message.html#parse(java.lang.String)">Message#parse(java.lang.String)</a>
				]]>
				and
				<![CDATA[
					<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/Message.html#encode()">Message#encode()</a>
				]]>
				now work correctly when the message parser is an XML based parser. Previously
				these convenience methods only worked for Pipe parsers. 
			</action>
			<action dev="Christian Ohr" type="fix" issue="3471571">
				<![CDATA[
					<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/Message.html#generateACK()">Message#generateACK()</a>
				]]>
				now respects the ModelClassFactory used to build/parse the message from which the ACK is being generated. This means
				for example that if a CanonicalModelClassFactory is used to construct a message, that same CMCF will be used to
				generate its ACK. Thanks to Rahul Somasunderam for reporting this and providing a workaround!
			</action>
        	<action type="fix">
        		The "Source" and "Javadoc" JAR bundles are once again being built and can be
        		downloaded along with the library JARs themselves.
			</action>			
			<action dev="James Agnew" type="add">
				Add a system property to 
				<![CDATA[
					<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/util/MessageIDGenerator.html#NEVER_FAIL_PROPERTY">MessageIDGenerator</a>
				]]>
				which prevents it from failing if it is unable to read or write the message file. (Not that this feature
				sometimes failed to work in 2.0-beta1. This has been corrected.)
			</action>
			<action dev="James Agnew" type="add">
				MessageIDGenerator has been modified so that it will never fail in the
				event of a problem reading or writing a file. This should help with
				unpredictable failures when id_file permissions get messed up or
				id_file gets corrupted.
			</action>
			<action dev="mblanchette" type="fix" issue="3472728">
				Correct an issue with the new ForcedEncode mode where for instance
				"PID-11-7" is read as "PID-1-7" and then incorrectly encoded.
			</action>
			<action dev="Rahul Somasunderam (Certify)" type="fix" issue="3471934">
				Prevent incorrect segment repetition number from appearing in 
				validation failure exception messages. Thanks to Rahul for providing a
				report with a working test case.
			</action>
			<action dev="Christian Ohr" type="fix" issue="2793050">
				Provide the
				<![CDATA[
					<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/validation/impl/DefaultValidationWithoutTN.html>DefaultValidationWithoutTN</a>
				]]>  
				class for default validation without the TN rule which is specific for U.S. phone numbers.
				In this context, adding RuleBindings to the ValidationContext has been made type-safe. A minor API
				change was necessary: RuleBindings require dedicated Rule types for initialization.
			</action>
			<action dev="Christian Ohr" type="fix" issue="3520790">
				MessageTypeRouter calls Application#canProcess method of selected application before
				delegating message handling. Thanks for submitting a patch.
			</action>
			<action dev="Christian Ohr" type="fix" issue="3519668">
				DTM/TSComponentOne did not allow hour-precision timestamps as defined as of HL7 v2.5.
			</action>
			<action dev="Christian Ohr" type="fix" issue="3532775">
				DTM contained non-serializable primitives (CommonTS, CommonTM, CommonDT). 
				Thanks to Guillaume (gga11729) for reporting.
			</action>
			<action dev="Christian Ohr" type="fix" issue="3530793">
				XMLParser now uses custom ModelClassFactory if provided. 
				Thanks to Stephen Doxsee for reporting.
			</action>
			<action dev="James Agnew" type="fix">
				Calling AbstractPrimitive#parse(String), for instance on an ST datatype,
				with a value of null now clears the value instead of throwing a NullPointerException. This
				brings the behaviour in line with that of AbstractComposite#parse(String)
			</action>
			<action dev="Jens Villadsen" type="fix" issue="3520523">
				<![CDATA[
				<a href="http://hl7api.sourceforge.net/v26/apidocs/ca/uhn/hl7v2/model/v26/message/RSP_K21.html">RSP_K21</a>
				]]>
				structure for v2.5.1 and v2.6 now has a repeatable QUERY_RESPONSE group. This 
				addresses an inconsistency in the HL7 specification for those two versions.
				Thanks to Jens Villadsen for reporting.
			</action>
			<action dev="Jure Grom" type="fix" issue="3538074">
				<![CDATA[
				<a href="http://hl7api.sourceforge.net/v251/apidocs/ca/uhn/hl7v2/model/v251/message/ORL_O34.html">ORL_O34</a>
				]]>
				structure for v2.5.1 has two child structures with the same name (SPECIMEN). The second is now
				named OBSERVATION_REQUEST_SPECIMEN to prevent a recursive loop when parsing an ORL^O34
				message. Thanks to Jure Grom for reporting.
			</action>
			<action dev="Eric Poisseau" type="fix" issue="3373654">
				<![CDATA[
				<a href="http://hl7api.sourceforge.net/v25/apidocs/ca/uhn/hl7v2/model/v25/message/ORL_O34.html">ORL_O34</a>
				]]>
				structure for v2.5 is missing an outer group called RESPONSE. This group contains only one
				nested group, so it doesn't do much but its absence could affect XML encoding.
				Thanks to Eric Poisseau for reporting.
			</action>
			<action dev="Fco. Javier BroullÃ³n" type="fix" issue="3454369">
				<![CDATA[
				<a href="http://hl7api.sourceforge.net/v23/apidocs/ca/uhn/hl7v2/model/v23/segment/MRG.html">MRG</a>
				]]>
				segment for v2.3 should have type XPN in position MRG.7 (Prior Patient Name) instead of type CX.
				Thanks to Fco. Javier BroullÃ³n for reporting.
			</action>
			<action dev="StÃ©phane" type="fix" issue="2864817">
				<![CDATA[
				<a href="http://hl7api.sourceforge.net/v23/apidocs/ca/uhn/hl7v2/model/v23/segment/PID.html">PID</a>
				]]>
				segment for v2.3 should allow repeatable elements in PID-5 (Patient Name).
				Thanks to StÃ©phane for reporting.
			</action>
		</release>
        <release version="1.2" date="2011-06-26"
            description="This release brings some bug fixes and a
  few enhancements. The primary focus of this release is in fixing issues relating to
  parsing and encoding. In particular, a number of issues specific to parsing of
  OBX-5 (Varies) values have been corrected.">
            <action type="fix" dev="James Agnew">
            	Fix one regression in HAPI 1.2-beta1, where a group containing at least one
            	mandatory segment would sometimes be encoded as an empty segment 
            	even if no content was added to it.
            </action>
            <action type="add" dev="James Agnew">
            	Add two new system properties which allow OBX segments messages to be parsed
            	even if they are either missing, or have an invalid value in OBX-2 (which defines
            	the datatype used in OBX-5).
				<![CDATA[
	            	<a href="./xref/ca/uhn/hl7v2/examples/ParseInvalidObx2Values.html">More information</a>
				]]>
            </action>
            <action type="add" dev="James Agnew">
            	Add new utility classes for iterating over 
            	a file containing multiple
            	ER7 encoded HL7 messages. 
				<![CDATA[
	            	<a href="./xref/ca/uhn/hl7v2/examples/ReadMessagesFromFile.html">See example</a>
				]]>
            </action>
            <action type="fix" dev="James Agnew">
            	Fix an issue where calling 
				<![CDATA[
    	        	<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/AbstractPrimitive.html#parse(java.lang.String)">AbstractPrimitive#parse(String)</a>
				]]>
            	(for example on an ST datatype) 
            	would not clear pre-existing 
				<![CDATA[
        	    	<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/Type.html#getExtraComponents()">extra components</a>
				]]>
            	if any were defined.
            </action>
            <action type="fix" dev="James Agnew">
            	When encoding a group using the PipeParser where the first segment is required, but no data has been populated in that segment, 
            	the empty segment is now still encoded if needed as a blank segment in order to give parsers a hint about which 
            	group further segments are in. This helps to ensure that messages can be "round tripped", meaning that
            	a message which is parsed, encoded, and then re-parsed should contain exactly the same structure from
            	beginning to end. 
            	For example, in an ORU^R01 message with a populated OBX segment, but no data
            	in the mandatory OBR segment which begins the ORDER_OBSERVATION group (see 
            	<![CDATA[<a href="http://hl7api.sourceforge.net/v26/apidocs/ca/uhn/hl7v2/model/v26/group/ORU_R01_ORDER_OBSERVATION.html">reference</a>]]>),
            	the message would still contain an empty OBR segment when encoded:
				<![CDATA[
<pre>
	MSH|^~\&|REG|W|||201103230042||ORU^R01|32153168|P|2.5
	OBR|
	OBX||ST|||Value Data
</pre>
				]]>
				Previously, the following encoding would have occurred, which would have incorrectly been parsed as
				having a custom OBX segment instead of having a normal ORDER_OBSERVATION group: 
				<![CDATA[
<pre>
	MSH|^~\&|REG|W|||201103230042||ORU^R01|32153168|P|2.5
	OBX||ST|||Value Data
</pre>
				]]>
            </action>
            <action type="add" dev="James Agnew">
            	<![CDATA[<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/Group.html">Group</a>]]>
            	interface now has a new method: isGroup(String). This method allows callers to determine
            	if a child structure is a segment or a group. The only provided implementation, AbstractGroup,
            	implements this method, so the API change should not have any effect on users.
            </action>
            <action type="fix" dev="James Agnew">
            	Restore missing get[FIELD_NAME]Reps() methods from segments. These were accidentally removed
            	with the conversion to a Velocity based structure generator, but they have now been
            	restored.
            </action>
            <action type="fix" dev="James Agnew" issue="3303344">
            	Avoid a NullPointerException if a null value is passed into the "setValue(Date)" or 
            	"setValue(Calendar)" methods on a DT, TS, or TM datatype. Passing in a null now
            	simply clears any existing value, bringing these methods in line with
            	the behaviour of the "setValue(String)" method. 
            	Thanks to Michael for reporting!
            </action>
            <action type="fix" dev="Stephane Giner" issue="3307882">
            	Fix potential race condition when using ConnectionHub in a multithreaded
            	environment.
            </action>
            <action type="fix" dev="Axel Biernat" issue="3308845">
            	Avoid line wrapping when XML encoding messages using the XMLParser. This means
            	that values with very long strings won't have unexpected breaks added when
            	they are encoded and re-parsed. 
            </action>
            <action type="fix" dev="James Agnew">
            	Correct issue where extra components in primitive types within OBX-5 appear twice when
            	message is re-encoded. This is useful, for example, if you are receiving messages
            	from a system which is not correctly escaping ampersands or carats within
            	an OBX-5 value. Prior to chis change, a message containing the following
            	segment:
				<![CDATA[
<pre>
   OBX||ST|||F1C1^F2C1&F2C2
</pre>
				]]>
            	Would be re-encoded as:
				<![CDATA[
<pre>
   OBX||ST|||F1C1&F2C2^F2C1&F2C2
</pre>
				]]>
				Thanks to Andbuty Choy for finding this.
            </action>
            <action type="fix" dev="James Agnew" issue="3306358">
            	Prevent MessageIDGenerator (used to generate message control IDs for ACK messages, for example in SimpleServer)
            	from throwing an exception if it is not able to parse the value found in id_file. Previously if something
            	went wrong and this file was blank, a hard to debug exception was thrown. Now, control ID sequencing is simply
            	reset to zero. Thanks to an anonymous bug submittor.
            </action>
            <action type="fix" dev="Rodolfo Chavez" issue="3264566">
            	Fix an issue where inserting/removing a repetition of the very last field in a segment
            	fails due to an incorrect range check in AbstractSegment. Thanks Rodolfo for submitting! 
            </action>
            <action type="fix" dev="James Agnew" issue="3212931">
            	Where multiple structures are marked as associated with the same trigger event 
            	(example: ORN_O02 and ORR_O02 are both indicated as matching trigger ORR^O02) the
            	parser will favour the structure whose name matches the event type and trigger (ORR_O02 in the
            	previous example) when parsing a message with no structure explicitly defined in MSH-9-3.
            </action>
            <action type="fix" dev="Ryan W. Gross">
            	Fix an issue where subcomponents within a Varies (OBX-5) value are incorrectly handled. For example,
            	if OBX-2 specifies a composite type, and the first component is also a composite, the first subcomponent
            	(represented by the text F1C2 below) would be lost.
				<![CDATA[
<pre>
	OBX||AD|||F1C1&F1C2^F2C1
</pre>
				]]>
            </action>
            <action type="fix" dev="James Agnew">
            	Correct a PipeParser parsing issue: When a message is being parsed which contains 
            	multiple unexpected segments, any unexpected segments after the first one may appear
            	out of order if the message is re-encoded.
            </action>
		</release>
        <release version="1.1" date="2011-03-28"
            description="This release contains a number of bug fixes and several new features.">
            <action type="add">HAPI libraries are now available in the Maven Central Repo. Thanks to Francis De Brabandere for figuring out how to make this happen!</action>
            <action type="fix" dev="Christian Ohr">(Regression in 1.0-beta1) Some structures contained incorrect version information which led to inability to parse Z segments</action>
            <action type="add" dev="James Agnew">Message types now have a convenience method initQuickstart which sets default values to MSH segment (field separator, message type, etc)</action>
            <action type="add" dev="James Agnew">HAPI now has a Maven plugin which generates Message/Group/Segment struxctures based on an HL7 conformance profile. See the <![CDATA[<a href="http://hl7api.sourceforge.net/conformance.html">conformance</a>]]> page for more information.</action>
            <action type="add" due-to="Gabriel Landais" issue="3164756">Allow users of HAPI SimpleServer to create an Application that handles errors. The provided patch adds an interface, which should be implemented by exception aware Applications. The application can then re-dispatch the provided ACK, or a create a completely new message.</action>
            <action type="fix" due-to="Pepe Juarez" issue="3115671">Correct XML encoding of OMD_O03. (OMD_O03.DIET was incorrectly being encoded simply as "DIE")</action>
            <action type="fix" due-to="Karl Weller" issue="3027567">Correct the spelling of the name TIMING in a number of group structures (e.g. OML_O21_TIMING which was previously OML_O21_TIIMING)</action>
            <action type="update" dev="James Agnew">Update structure classes source generator to use an Apache Velocity based template instead of simple hard-coded string concatenation. This will make it much easier to add new features to the structures in the future.</action>
            <action type="update" dev="James Agnew">Message now has a method <![CDATA[<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/Message.html#printStructure%28%29">Message#printStructure()</a>]]>, which returns a useful String for debugging containing a description of the entire structure of the message</action>
            <action type="fix" dev="James Agnew">GenericParser ignores custom ModelClassFactory implementations passed into its constructor. Thanks to John R for reporting.</action>
            <action type="fix" due-to="Yildiray Kabak">XML parser now parses subsequent datatype components correctly when a component is missing. E.g. if ED.1 is missing but ED.2 is present: Previously, ED.2 would be parsed as ED.1.</action>
            <action type="fix" due-to="Torsten from Agfa Healthcare" issue="3031998">Parsing OBX-5 failed when value (as indicated by OBX-2) was a type which requires a table number (IS or ID). HAPI now defaults to table 0.</action>
            <action type="fix" due-to="Karl Weller" issue="3027567">Parsing OBX-5 failed when value (as indicated by OBX-2) was a type which requires a table number (IS or ID). HAPI now defaults to table 0.</action>
            <action type="fix" due-to="Kalle Eskola">Add check to ConnectionHub to avoid returning a connection which was explicitly closed. Also update "send and receive" example in documentation to show correct way of discarding a connection using ConnectionHub.</action>
            <action type="add" dev="James Agnew">HAPI now logs the current version as it is being initialized, for troubleshooting purposes.</action>
            <action type="add" dev="James Agnew">Add getters and setters to DT, TM, and TS data types to get and set values using standard Java Date and Calendar objects. (Examples <![CDATA[<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/primitive/CommonDT.html#getValueAsCalendar%28%29">here</a> and <a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/primitive/CommonDT.html#setValue%28java.util.Calendar%29">here</a>]]>)</action>
            <action type="add" dev="James Agnew">Add <![CDATA[<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/parser/PipeParser.html#getInstanceWithNoValidation()">factory method</a>]]> to PipeParser which returns an instance with validation disabled (useful for one-liner parse routines)</action>
            <action type="add" dev="James Agnew">Add <![CDATA[<a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/model/Varies.html#INVALID_OBX2_TYPE_PROP">system property</a>]]> to allow OBX-2 to contain invalid values and still parse</action>
        </release>
        <release version="1.0.1" date="2010-05-16"
            description="This release corrects a single issue">
            <action type="fix" due-to="Irving Reid" issue="3002194">Correct an issue where a NullPointerException occurs if a mandatory segment at the end of a message is not present</action>
        </release>
		<release version="1.0" date="2010-04-12"
            description="This release adds a newly reworked PipeParser, and number of new features">
            <action type="fix">Correct regression introduced in 1.0-beta1 where a second segment within a group with the same name (i.e. the two PID segments in an ADT^A17) fails to parse correctly.</action>
            <action type="fix">Provide default implementation of new abstract method "createNewTypeWithoutReflection" on AbstractSegment class to prevent breaking existing user defined types. Thanks to Christian Ohr for reporting.</action>
            <action type="update" dev="James Agnew">Clean up logging in ServerSocketStreamSource (used by HL7Server) so that it doesn't spew unneccesary logs while waiting for a connection</action>
            <action type="update" dev="James Agnew">Remove all test suites (not tests, just the suites), as they cause maven to execute tests twice, and clean up test execution. Full test suie execution is down to ~90 seconds from 10 mins.</action>
            <action type="add" due-to="Christian Ohr, Niranjan Sharma"><![CDATA[Add two new ModelClassFactory implementations: <a href="base/apidocs/ca/uhn/hl7v2/parser/CanonicalModelClassFactory.html">CanonicalModelClassFactory</a> (always returns the same version), and <a href="base/apidocs/ca/uhn/hl7v2/parser/CustomModelClassFactory.html">CustomModelClassFactory</a> (provides easy way to use custom structure packages)]]></action>
            <action type="fix" dev="James Agnew">Fix a bug where formatting escape sequences were stripped from messages (i.e. leave sequences such as /.br/ alone)</action>
            <action type="add" due-to="Christian Ohr">Overhaul Escape class (handles HL7 escape sequences) to dramatically improve performance</action>
            <action type="fix" due-to="Jan Klasser" issue="1809573">Fix NullPointerException in DefaultValidator when no table present for an ID datatype</action>
            <action type="fix" dev="James Agnew">Allow parsing of unknown message types for 2.5.1 and 2.6 messages</action>
            <action type="update" dev="James Agnew">Convert HAPI source version JDK 5.0. This allows the use (and begins a gradual conversion) to generics by HAPI's internal structures. Support for JDK1.4 will still remain through version specific JARs produced by RetroTranslator.</action>
            <action type="add" dev="James Agnew">Add getNames() method to Segment, to allow programatic access to segment's field names (needed by hUnit)</action>
            <action type="fix" due-to="Gerald Bortis, Christian Ohr" issue="1263250">Fix serialization of HAPI Message objects. Also added serialVersionUID to a number of core classes.</action>
            <action type="fix" due-to="Chris Busch">Fix a memory leak in Escape.java when lots of different encoding chars are used</action>
			<action type="fix" dev="James Agnew">Modify ProcessorImpl (HL7Server processing class) to use an ExecutorService instead of spawning a new thread for each message to generate ACKs.</action>
			<action type="fix" due-to="Gerald Bortis, Polloloco" issue="2164291">Fix XML parsing of seg groups containing more than one instance of the same segment (e.g. A17)</action>
		</release>
		<release version="0.6" date="2009-07-01"
			description="This release adds support for HL7 2.5.1 and 2.6, as well as fixing a number of issues and introducing a new build system.">			
			<action type="add" due-to="Christian Ohr" issue="2793054">Add constructors to all parser types allowing a custom model factory</action>
			<action type="fix" due-to="Gerald Bortis, Polloloco" issue="2164291">Fix XML parsing of seg groups containing more than one instance of the same segment (e.g. A17)</action>
			<action type="add" due-to="Peter Gershkovich">Added isRunning() method to SimpleServer</action>
			<action type="add" dev="James Agnew">Add NULLDT datatype, to be used in withdrawn fields. Note that default validation expects this datatype to be empty, but custom validation does not need to enforce this.</action>
			<action type="add" dev="James Agnew">Add setEncoding method to XmlParser to allow text encoding to be specified when creating XML messages. In response to mailing list query from Fernando RamÃ­rez SÃ¡nchez</action>
			<action type="add" due-to="Chris Horneck" issue="1890219">Add single argument constructor to ID datatype, to allow it to be used in OBX-5</action>
			<action type="add" dev="James Agnew">New HAPI maven repository now available at http://hl7api.sourceforge.net/m2/</action>
			<action type="fix" due-to="FrÃ©dÃ©ric Dubru">Make PipeParser not crash on empty segments (meaning segments with just a segment name, no field separator or fields)</action>
			<action type="fix" due-to="Greg Groves" issue="1662979">NullPointerException if OBX-2 is invalid and OBX-5 is set</action>
			<action type="fix" dev="btripp" issue="1657929">Parsing fails when (pipe) is used as non-field separator</action>
			<action type="add" dev="James Agnew">Allow Parser to accept a null ValidationContext, which will prevent any attempt at validating messages from being made.</action>
			<action type="add" due-to="Andy Pardue">Allow Parsers now get their default validation context from ValidationContextFactory if none is supplied</action>
			<action type="add" due-to="Andy Pardue">Allow A new system property (See Varies JavaDoc) may be specified to supply a default datatype to be assumed for OBX-5 if none is found in OBX-2. A missing OBX-2 is not a valid case, but this property would allow a user to work around problems receiving from a bad message source</action>
		</release>
		<release version="0.5.1" date="2007-02-18"
			description="This release fixes only one issue. In the previous release (0.5), some classes were released with a dependency on Java 5. HAPI officially supports JDK version 1.4, so this release corrects the dependency.">
			<action type="fix" dev="James Agnew">Remove JDK 5 dependency</action>
		</release>
		<release version="0.5" date="2006-12-14">
			<action type="fix" issue="1557203">hapi 0.4.3 Class Parser : Multi-threading conflict can occur</action>
			<action type="fix" issue="1547989">Unescaping in XMLParser.getCriticalResponseData()    </action>
			<action type="fix" issue="1539866">PipeParser.getCriticalResponseData() does not use version</action>
			<action type="fix" issue="1539352">NullPointerException on garbage messages </action>
			<action type="fix" issue="1536231">Class ExtraComponents not Serializable</action>
			<action type="fix" issue="1536200">"I" instead of "PID" freezes the parser</action>
			<action type="fix" issue="1525034">validation contexts are not used during parsing</action>
			<action type="fix" issue="1525029">Error generating error responses for XML messages</action>
			<action type="fix" issue="1482059">SIU S12 Segment Issue  </action>
			<action type="fix" issue="1405670">DFT-P03 - incorrect message structure</action>
			<action type="fix" issue="1377382">NM integer magnitude limited to java int</action>
			<action type="fix" issue="1368028">ORU_R01_OBSERVATION incorrectly defined</action>
			<action type="fix" issue="1284281">OBX-5 type assignment only operates on first rep</action>
			<action type="fix" issue="260957">Missing Code in Version 2.5</action>
			<action type="fix" issue="1240698">ORL_O34 message incorrectly defined</action>
		</release>
	</body>
</document>
